<div class="admin-dashboard">
  <!-- Header -->
  <div class="dashboard-header">
    <h1>Admin Dashboard</h1>
    <p class="subtitle">Welcome back! Here's what's happening today.</p>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Loading dashboard...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-container">
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="loadDashboardStats()">Retry</button>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading && !error && stats" class="dashboard-content">
    
    <!-- Quick Stats Grid -->
    <div class="stats-grid">
      <!-- Users Stats -->
      <div class="stat-card" (click)="navigateTo('users')">
        <div class="stat-icon users">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2"/>
            <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <div class="stat-content">
          <h3>Total Users</h3>
          <p class="stat-number">{{ stats.totalUsers | number }}</p>
          <div class="stat-details">
            <span class="detail-item">{{ stats.totalHosts }} Hosts</span>
            <span class="detail-item">{{ stats.totalGuests }} Guests</span>
          </div>
        </div>
      </div>

      <!-- Properties Stats -->
      <div class="stat-card" (click)="navigateTo('properties')">
        <div class="stat-icon properties">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" stroke="currentColor" stroke-width="2"/>
            <polyline points="9 22 9 12 15 12 15 22" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <div class="stat-content">
          <h3>Properties</h3>
          <p class="stat-number">{{ stats.totalProperties | number }}</p>
          <div class="stat-details">
            <span class="detail-item active">{{ stats.activeProperties }} Active</span>
            <span class="detail-item pending">{{ stats.pendingProperties }} Pending</span>
          </div>
        </div>
      </div>

      <!-- Bookings Stats -->
      <div class="stat-card" (click)="navigateTo('bookings')">
        <div class="stat-icon bookings">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
            <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
            <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
            <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <div class="stat-content">
          <h3>Bookings</h3>
          <p class="stat-number">{{ stats.totalBookings | number }}</p>
          <div class="stat-details">
            <span class="detail-item">{{ stats.activeBookings }} Active</span>
            <span class="detail-item">{{ bookingCompletionRate | number:'1.0-0' }}% Complete</span>
          </div>
        </div>
      </div>

      <!-- Revenue Stats -->
      <div class="stat-card revenue" (click)="navigateTo('analytics')">
        <div class="stat-icon revenue">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <line x1="12" y1="1" x2="12" y2="23" stroke="currentColor" stroke-width="2"/>
            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <div class="stat-content">
          <h3>Total Revenue</h3>
          <p class="stat-number">EGP{{ stats.totalRevenue | number:'1.2-2' }}</p>
          <div class="stat-details">
            <span class="detail-item growth">+{{ revenueGrowth | number:'1.1-1' }}% this month</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Action Cards -->
    <div class="action-cards">
      <!-- Pending Verifications -->
      <div class="action-card urgent" *ngIf="stats.pendingVerifications > 0" 
           (click)="navigateTo('verifications')">
        <div class="action-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" stroke="currentColor" stroke-width="2"/>
            <polyline points="22 4 12 14.01 9 11.01" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <div class="action-content">
          <h4>Pending Verifications</h4>
          <p class="action-count">{{ stats.pendingVerifications }}</p>
          <p class="action-description">User identity verifications awaiting review</p>
        </div>
        <div class="action-arrow">→</div>
      </div>

      <!-- Blocked Users -->
      <div class="action-card info" *ngIf="stats.blockedUsers > 0" 
           (click)="navigateTo('users')">
        <div class="action-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <line x1="4.93" y1="4.93" x2="19.07" y2="19.07" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <div class="action-content">
          <h4>Blocked Users</h4>
          <p class="action-count">{{ stats.blockedUsers }}</p>
          <p class="action-description">Currently blocked accounts</p>
        </div>
        <div class="action-arrow">→</div>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-section">
      <!-- Revenue Chart -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>Revenue Overview</h3>
          <p class="chart-subtitle"></p>
        </div>
        <div class="chart-placeholder">
          <div class="chart-bars">
            <div *ngFor="let month of stats.revenueByMonth" class="bar-container">
              <div class="tooltip">
                <span class="tooltip-price">EGP{{ month.revenue | number:'1.0-0' }}</span>
                <span class="tooltip-count">{{ month.bookingsCount }} bookings</span>
                <div class="tooltip-arrow"></div>
              </div>

              <!-- العمود -->
              <div class="bar" 
                   [style.height.%]="getMaxRevenue() > 0 ? (month.revenue / getMaxRevenue()) * 100 : 0">
              </div>
              
              <!-- اسم الشهر -->
              <span class="bar-label">{{ month.month }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Property Types -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>Property Types</h3>
          <p class="chart-subtitle">Distribution</p>
        </div>
        <div class="property-types-list">
          <div *ngFor="let type of stats.propertyTypeStats" class="property-type-item">
            <div class="type-info">
              <span class="type-name">{{ type.propertyType }}</span>
              <span class="type-count">{{ type.count }} properties</span>
            </div>
            <div class="type-revenue">EGP{{ type.totalRevenue | number:'1.0-0' }}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Recent Activity -->
    <div class="recent-activity">
      <h3>Platform Overview</h3>
      <div class="activity-grid">
        <div class="activity-item">
          <span class="activity-label">Average Rating</span>
          <span class="activity-value">{{ stats.averageRating | number:'1.1-1' }} ⭐</span>
        </div>
        <div class="activity-item">
          <span class="activity-label">Total Reviews</span>
          <span class="activity-value">{{ stats.totalReviews | number }}</span>
        </div>
        <div class="activity-item">
          <span class="activity-label">Platform Fees</span>
          <span class="activity-value">EGP{{ stats.platformFees | number:'1.2-2' }}</span>
        </div>
        <div class="activity-item">
          <span class="activity-label">Active Users</span>
          <span class="activity-value">{{ stats.activeUsers | number }}</span>
        </div>
      </div>
    </div>
  </div>
</div>