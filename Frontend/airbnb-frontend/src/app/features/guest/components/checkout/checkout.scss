// ================= VARIABLES =================
$border-color: #B0B0B0;
$text-color: #222222;
$error-red: #c13515;
$error-bg: #fff8f6;
$primary-black: #222222;

// ================= GLOBAL LAYOUT =================
.checkout-page {
  max-width: 1120px;
  margin: 0 auto;
  padding: 40px 24px;
  font-family: 'Circular', -apple-system, sans-serif;
  color: $text-color;

  // Header Section
  .checkout-header {
    display: flex; align-items: center; gap: 24px; margin-bottom: 48px;

    .back-btn {
      background: transparent; border: none; padding: 10px; border-radius: 50%; cursor: pointer; font-size: 16px;
      &:hover { background: #f7f7f7; }
    }
    h1 { font-size: 32px; font-weight: 600; margin: 0; }
  }

  // Main Grid System
  .main-grid {
    display: grid;
    grid-template-columns: 1.3fr 1fr; // Left column slightly larger
    gap: 80px;

    // ================= LEFT COLUMN =================
    .left-section {

      // Step Titles
      .step-header {
        margin-bottom: 24px;
        h2 { font-size: 22px; font-weight: 600; margin: 0; }
        &.disabled h2 { color: $border-color; }
      }

      // The White Box Container (Payment Form)
      .payment-card-box {
        background: white;
        border: 1px solid #dddddd;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12); // The Airbnb Shadow
        margin-bottom: 32px;
      }

      // Payment Method Header inside the box
      .payment-method-header {
        display: flex; justify-content: space-between; align-items: center;
        margin-bottom: 24px;

        .method-info {
          display: flex; align-items: center; gap: 12px; font-weight: 600;
          i { font-size: 20px; }
        }
        .radio-circle {
          width: 20px; height: 20px; border: 6px solid #222; border-radius: 50%;
        }
      }

      // === INPUTS STYLING (THE CORE FIX) ===
      .form-inputs, .billing-inputs {

        .input-row {
          position: relative;

          input, select {
            width: 100%;
            padding: 16px;
            border: 1px solid $border-color;
            border-radius: 0; // Default square
            outline: none;
            font-size: 16px;
            margin-bottom: -1px; // Collapse borders
            background: white;
            position: relative;
            z-index: 1;

            &:focus {
              border-color: #222;
              border-width: 2px;
              z-index: 10;
              border-radius: 4px; // Slight radius on focus
            }

            // Error State styling
            &.error {
              border: 1px solid $error-red !important;
              background-color: $error-bg !important;
              z-index: 5;

              &:focus {
                border-color: $error-red !important;
                box-shadow: 0 0 0 1px $error-red;
              }
            }
          }

          // Icons inside inputs (Lock, Chevron)
          .lock-icon, .fa-chevron-down {
            position: absolute; right: 16px; top: 18px; color: #717171; pointer-events: none; z-index: 20;
          }

          // --- Rounding Logic (Fixing Corners) ---

          // 1. Top Row (Card Number / Street)
          &.top input { border-radius: 8px 8px 0 0; }

          // 2. Middle Row (No radius)
          &.middle input, &.middle select { border-radius: 0; }

          // 3. Bottom Row (Country Select)
          &.bottom select, &.bottom input { border-radius: 0 0 8px 8px; }

          // 4. Split Row (Expiration / CVV / State / Zip)
          &.split {
            display: flex;
            .half { width: 50%; }

            // Left half logic
            .left input {
              border-right: none; // Avoid double border
              border-bottom-left-radius: 8px; // Round bottom-left
            }

            // Right half logic
            .right input {
              border-bottom-right-radius: 8px; // Round bottom-right
            }

            // Special case: If split is NOT at the bottom (like State/Zip in billing)
            // We need to remove bottom radius if there are rows below it
            &:not(:last-child) {
              .left input { border-bottom-left-radius: 0; }
              .right input { border-bottom-right-radius: 0; }
            }
          }
        }
      }

      // Billing Section Title
      .billing-section {
        margin-top: 32px;
        h3 { font-size: 16px; font-weight: 600; margin-bottom: 16px; }
      }

      // Error Message Box
      .error-msg-box {
        display: flex; align-items: center; gap: 8px; margin-top: 8px; margin-bottom: 12px;
        i, span { color: $error-red; font-size: 12px; }
        span { font-weight: 400; }
      }

      // Black Submit Button
      .btn-black {
        margin-top: 32px;
        background: $primary-black; color: white;
        width: 180px; padding: 14px;
        border: none; border-radius: 8px;
        font-size: 16px; font-weight: 600; cursor: pointer;
        transition: transform 0.1s;

        &:hover { background: black; }
        &:active { transform: scale(0.98); }
        &:disabled { background: #dddddd; cursor: not-allowed; }
      }

      .divider { border: 0; border-top: 1px solid #ddd; margin: 40px 0; }
    }


    // ================= RIGHT COLUMN =================
    .right-section {
      .sticky-wrapper { position: sticky; top: 100px; }

      .summary-card {
        border: 1px solid #ddd; border-radius: 12px; padding: 24px; background: white;

        .card-header-row {
          display: flex; gap: 16px;
          img { width: 100px; height: 100px; border-radius: 8px; object-fit: cover; }
          .text-info {
            .superhost-tag { font-size: 12px; font-weight: 600; color: #222; }
            .listing-desc { font-size: 12px; color: #717171; margin: 2px 0; }
            h4 { font-size: 14px; line-height: 1.4; font-weight: 400; margin: 4px 0; }
            .rating { font-size: 12px; font-weight: 600; i { font-size: 10px; } }
          }
        }

        .divider { border: 0; border-top: 1px solid #ebebeb; margin: 24px 0; }

        .policy-section {
           h4 { font-size: 16px; margin-bottom: 4px; }
           p { font-size: 14px; color: #717171; line-height: 1.4; a { color: #222; font-weight: 600; text-decoration: underline; } }
        }

        .trip-details {
          .detail-row {
            display: flex; justify-content: space-between; margin-bottom: 20px;
            &:last-child { margin-bottom: 0; }
            h4 { font-size: 16px; margin-bottom: 2px; }
            p { font-size: 14px; color: #222; }
            .link-btn { background: none; border: none; text-decoration: underline; font-weight: 600; cursor: pointer; font-size: 16px;}
          }
        }

        .price-section {
          h4 { font-size: 22px; margin-bottom: 16px; }
          .line-item {
            display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 16px;
            &.total { font-weight: 800; margin-top: 16px; }
          }
        }
      }

      .rare-find-box {
        margin-top: 24px; display: flex; gap: 16px; align-items: flex-start;
        i { font-size: 24px; color: #E31C5F; margin-top: 2px; }
        .text {
           h4 { font-size: 16px; font-weight: 600; margin-bottom: 4px; }
           p { font-size: 14px; color: #717171; line-height: 1.4; }
        }
      }
    }
  }
  .paypal-wrapper {
    margin-top: 16px;
    // نتأكد إن الزرار واخد العرض المناسب
    width: 100%;
    z-index: 1;
    position: relative;
  }

  .secure-text {
    font-size: 12px; color: #717171; margin-top: 16px; display: flex; align-items: center; gap: 6px;
    i { font-size: 10px; }
  }

  // ================= MODALS STYLING =================
  .modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.5);
    display: flex; justify-content: center; align-items: center;
    z-index: 2000;

    .modal-box {
      background: white; padding: 24px; border-radius: 12px; width: 320px; box-shadow: 0 4px 20px rgba(0,0,0,0.2);
      h3 { margin-bottom: 16px; font-size: 18px; font-weight: 600; }
      .modal-inputs {
        display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px;
        label { font-size: 14px; font-weight: 600; }
        input { padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px;}
      }
      .modal-actions {
        display: flex; justify-content: flex-end; gap: 16px;
        .cancel-btn { background: transparent; border: none; text-decoration: underline; cursor: pointer; font-weight: 600; }
        .save-btn { background: #222; color: white; border: none; padding: 8px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; }
      }
    }
  }

  // Responsive
  @media (max-width: 900px) {
    .main-grid { grid-template-columns: 1fr; }
    .right-section { order: -1; margin-bottom: 40px; }
  }
}
