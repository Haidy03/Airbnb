<div class="flex items-center border border-gray-300 rounded-full shadow-sm hover:shadow-md transition-shadow bg-white">
  <!-- Where -->
  <button
    (click)="openSearchModal('where')"
    class="flex-1 px-6 py-3 text-left border-r border-gray-300 rounded-l-full hover:bg-gray-50">
    <div class="text-xs font-semibold text-gray-900">Where</div>
    <div class="text-sm text-gray-500 truncate">
      {{ searchData.where || 'Search destinations' }}
    </div>
  </button>

  <!-- When -->
  <button
    (click)="openSearchModal('when')"
    class="flex-1 px-6 py-3 text-left border-r border-gray-300 hover:bg-gray-50">
    <div class="text-xs font-semibold text-gray-900">When</div>
    <div class="text-sm text-gray-500 truncate">
      {{ searchData.when || 'Add dates' }}
    </div>
  </button>

  <!-- Who -->
  <div class="flex items-center flex-1">
    <button
      (click)="openSearchModal('who')"
      class="flex-1 px-6 py-3 text-left hover:bg-gray-50">
      <div class="text-xs font-semibold text-gray-900">Who</div>
      <div class="text-sm text-gray-500 truncate">
        {{ searchData.who || 'Add guests' }}
      </div>
    </button>

    <!-- Search Button -->
    <button
      (click)="handleSearch()"
      class="bg-[#FF385C] hover:bg-[#E31C5F] text-white rounded-full p-3 mr-2 transition-colors">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
      </svg>
    </button>
  </div>
</div>

<!-- Search Modal Overlay -->
<div
  *ngIf="isSearchModalOpen"
  class="fixed inset-0 bg-black bg-opacity-50 z-50"
  (click)="closeSearchModal()">
  <div
    class="absolute top-20 left-1/2 transform -translate-x-1/2 bg-white rounded-3xl shadow-2xl p-8 w-full max-w-4xl"
    (click)="$event.stopPropagation()">

    <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-semibold">Search</h2>
      <button
        (click)="closeSearchModal()"
        class="p-2 hover:bg-gray-100 rounded-full">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </div>

    <!-- Modal Content Based on Active Section -->
    <div class="space-y-6">
      <!-- Where Section -->
      <div *ngIf="activeSearchSection === 'where'" class="space-y-4">
        <label class="block text-sm font-semibold text-gray-900">Where to?</label>
        <input
          type="text"
          [(ngModel)]="searchData.where"
          placeholder="Search destinations"
          class="w-full px-6 py-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#FF385C] text-lg">

        <div class="grid grid-cols-3 gap-4 mt-6">
          <button
            *ngFor="let destination of popularDestinations"
            (click)="selectDestination(destination)"
            class="p-4 border border-gray-300 rounded-xl hover:border-gray-900 transition-colors text-left">
            <div class="font-medium text-sm">{{ destination }}</div>
          </button>
        </div>
      </div>

      <!-- When Section -->
      <div *ngIf="activeSearchSection === 'when'" class="space-y-4">
        <label class="block text-sm font-semibold text-gray-900">When?</label>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-xs text-gray-600 mb-2">Check in</label>
            <input
              type="date"
              [(ngModel)]="searchData.checkIn"
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#FF385C]">
          </div>
          <div>
            <label class="block text-xs text-gray-600 mb-2">Check out</label>
            <input
              type="date"
              [(ngModel)]="searchData.checkOut"
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#FF385C]">
          </div>
        </div>
      </div>

      <!-- Who Section -->
      <div *ngIf="activeSearchSection === 'who'" class="space-y-4">
        <label class="block text-sm font-semibold text-gray-900">Who's coming?</label>

        <div class="space-y-4">
          <div class="flex items-center justify-between py-4 border-b border-gray-200">
            <div>
              <div class="font-medium">Adults</div>
              <div class="text-sm text-gray-500">Ages 13 or above</div>
            </div>
            <div class="flex items-center space-x-4">
              <button
                (click)="decrementGuests('adults')"
                [disabled]="guestCounts.adults <= 0"
                class="w-8 h-8 rounded-full border border-gray-300 hover:border-gray-900 disabled:opacity-30 disabled:cursor-not-allowed">
                <span class="text-gray-600">−</span>
              </button>
              <span class="w-8 text-center">{{ guestCounts.adults }}</span>
              <button
                (click)="incrementGuests('adults')"
                class="w-8 h-8 rounded-full border border-gray-300 hover:border-gray-900">
                <span class="text-gray-600">+</span>
              </button>
            </div>
          </div>

          <div class="flex items-center justify-between py-4 border-b border-gray-200">
            <div>
              <div class="font-medium">Children</div>
              <div class="text-sm text-gray-500">Ages 2-12</div>
            </div>
            <div class="flex items-center space-x-4">
              <button
                (click)="decrementGuests('children')"
                [disabled]="guestCounts.children <= 0"
                class="w-8 h-8 rounded-full border border-gray-300 hover:border-gray-900 disabled:opacity-30 disabled:cursor-not-allowed">
                <span class="text-gray-600">−</span>
              </button>
              <span class="w-8 text-center">{{ guestCounts.children }}</span>
              <button
                (click)="incrementGuests('children')"
                class="w-8 h-8 rounded-full border border-gray-300 hover:border-gray-900">
                <span class="text-gray-600">+</span>
              </button>
            </div>
          </div>

          <div class="flex items-center justify-between py-4">
            <div>
              <div class="font-medium">Infants</div>
              <div class="text-sm text-gray-500">Under 2</div>
            </div>
            <div class="flex items-center space-x-4">
              <button
                (click)="decrementGuests('infants')"
                [disabled]="guestCounts.infants <= 0"
                class="w-8 h-8 rounded-full border border-gray-300 hover:border-gray-900 disabled:opacity-30 disabled:cursor-not-allowed">
                <span class="text-gray-600">−</span>
              </button>
              <span class="w-8 text-center">{{ guestCounts.infants }}</span>
              <button
                (click)="incrementGuests('infants')"
                class="w-8 h-8 rounded-full border border-gray-300 hover:border-gray-900">
                <span class="text-gray-600">+</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex justify-end space-x-4 pt-6 border-t border-gray-200">
        <button
          (click)="clearSearch()"
          class="px-6 py-3 text-sm font-semibold text-gray-900 underline hover:bg-gray-50 rounded-lg">
          Clear all
        </button>
        <button
          (click)="applySearch()"
          class="px-8 py-3 text-sm font-semibold text-white bg-[#FF385C] hover:bg-[#E31C5F] rounded-lg transition-colors">
          Search
        </button>
      </div>
    </div>
  </div>
</div>
