<!-- src/app/features/guest/components/search/components/search-bar/search-bar.component.html -->

<div class="search-bar-container">
  <div class="search-bar">
    <!-- Location Input -->
    <div
      class="search-input-wrapper location-input"
      [class.active]="activeInput === 'location'"
    >
      <label class="input-label">Where</label>
      <input
        type="text"
        class="search-input"
        placeholder="Search destinations"
        [(ngModel)]="location"
        (focus)="onInputFocus('location')"
        (blur)="onInputBlur()"
      >
      <button
        *ngIf="location"
        class="clear-btn"
        (click)="clearLocation()"
        type="button"
      >
        <i class="bi bi-x-circle-fill"></i>
      </button>
    </div>

    <div class="search-divider"></div>

    <!-- Check-in Input -->
    <div
      class="search-input-wrapper date-input"
      [class.active]="activeInput === 'checkIn'"
    >
      <label class="input-label">Check in</label>
      <input
        type="date"
        class="search-input"
        placeholder="Add dates"
        [(ngModel)]="checkIn"
        (focus)="onInputFocus('checkIn')"
        (blur)="onInputBlur()"
      >
    </div>

    <div class="search-divider"></div>

    <!-- Check-out Input -->
    <div
      class="search-input-wrapper date-input"
      [class.active]="activeInput === 'checkOut'"
    >
      <label class="input-label">Check out</label>
      <input
        type="date"
        class="search-input"
        placeholder="Add dates"
        [(ngModel)]="checkOut"
        [min]="checkIn"
        (focus)="onInputFocus('checkOut')"
        (blur)="onInputBlur()"
      >
      <button
        *ngIf="checkIn || checkOut"
        class="clear-btn"
        (click)="clearDates()"
        type="button"
      >
        <i class="bi bi-x-circle-fill"></i>
      </button>
    </div>

    <div class="search-divider"></div>

    <!-- Guests Input -->
    <div
      class="search-input-wrapper guests-input"
      [class.active]="activeInput === 'guests'"
    >
      <label class="input-label">Who</label>
      <input
        type="text"
        class="search-input"
        [value]="guestsText"
        readonly
        (focus)="onInputFocus('guests')"
        (blur)="onInputBlur()"
      >

      <!-- Guests Dropdown -->
      <div *ngIf="showGuestsDropdown" class="guests-dropdown">
        <!-- Adults -->
        <div class="guest-row">
          <div class="guest-info">
            <div class="guest-type">Adults</div>
            <div class="guest-description">Ages 13 or above</div>
          </div>
          <div class="guest-controls">
            <button
              class="guest-btn"
              [disabled]="adultsCount <= 1"
              (click)="decrementGuests('adults')"
              type="button"
            >
              <i class="bi bi-dash-circle"></i>
            </button>
            <span class="guest-count">{{ adultsCount }}</span>
            <button
              class="guest-btn"
              [disabled]="adultsCount >= 16"
              (click)="incrementGuests('adults')"
              type="button"
            >
              <i class="bi bi-plus-circle"></i>
            </button>
          </div>
        </div>

        <!-- Children -->
        <div class="guest-row">
          <div class="guest-info">
            <div class="guest-type">Children</div>
            <div class="guest-description">Ages 2â€“12</div>
          </div>
          <div class="guest-controls">
            <button
              class="guest-btn"
              [disabled]="childrenCount <= 0"
              (click)="decrementGuests('children')"
              type="button"
            >
              <i class="bi bi-dash-circle"></i>
            </button>
            <span class="guest-count">{{ childrenCount }}</span>
            <button
              class="guest-btn"
              [disabled]="childrenCount >= 15"
              (click)="incrementGuests('children')"
              type="button"
            >
              <i class="bi bi-plus-circle"></i>
            </button>
          </div>
        </div>

        <!-- Infants -->
        <div class="guest-row">
          <div class="guest-info">
            <div class="guest-type">Infants</div>
            <div class="guest-description">Under 2</div>
          </div>
          <div class="guest-controls">
            <button
              class="guest-btn"
              [disabled]="infantsCount <= 0"
              (click)="decrementGuests('infants')"
              type="button"
            >
              <i class="bi bi-dash-circle"></i>
            </button>
            <span class="guest-count">{{ infantsCount }}</span>
            <button
              class="guest-btn"
              [disabled]="infantsCount >= 5"
              (click)="incrementGuests('infants')"
              type="button"
            >
              <i class="bi bi-plus-circle"></i>
            </button>
          </div>
        </div>

        <!-- Pets -->
        <div class="guest-row">
          <div class="guest-info">
            <div class="guest-type">Pets</div>
            <div class="guest-description">
              <a href="javascript:void(0)" class="pets-link">Bringing a service animal?</a>
            </div>
          </div>
          <div class="guest-controls">
            <button
              class="guest-btn"
              [disabled]="petsCount <= 0"
              (click)="decrementGuests('pets')"
              type="button"
            >
              <i class="bi bi-dash-circle"></i>
            </button>
            <span class="guest-count">{{ petsCount }}</span>
            <button
              class="guest-btn"
              [disabled]="petsCount >= 5"
              (click)="incrementGuests('pets')"
              type="button"
            >
              <i class="bi bi-plus-circle"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Search Button -->
    <button class="search-btn" (click)="onSearch()" type="button">
      <i class="bi bi-search"></i>
      <span class="search-btn-text">Search</span>
    </button>
  </div>

  <!-- Filters Button -->
  <button class="filters-toggle-btn" (click)="onFiltersClick()" type="button">
    <i class="bi bi-sliders"></i>
    <span>Filters</span>
  </button>
</div>
