<div class="property-list-container p-3">

  <!-- Header: Results Count & Sort -->
  <div class="list-header d-flex justify-content-between align-items-center mb-3 flex-wrap">
    <div class="results-info">
      <h2 class="results-count mb-0 h5 fw-bold">{{ totalProperties }} stays found</h2>
    </div>
    <div class="sort-options d-flex align-items-center mt-2 mt-lg-0">
      <label for="sort-select" class="me-2 fw-semibold small">Sort by:</label>
      <select
        id="sort-select"
        class="form-select form-select-sm border-secondary"
        [(ngModel)]="sortOption"
        (change)="onSortChange($event)"
      >
        <option value="popular">Most Popular</option>
        <option value="price_asc">Price: Low to High</option>
        <option value="price_desc">Price: High to Low</option>
        <option value="rating">Highest Rating</option>
        <option value="newest">Newest</option>
      </select>
    </div>
  </div>

  <!-- Loading State (Managed by Parent input) -->
  <!-- لاحظ: الأب هو اللي بيتحكم في isLoading -->

  <!-- Properties Grid -->
  <div *ngIf="properties.length > 0" class="properties-grid row g-4">
    <div class="col-12 col-md-6 col-lg-4 col-xl-4" *ngFor="let property of properties">
      <!-- تأكد ان app-property-card بيستقبل inputs صح -->
      <app-property-card
        [property]="property"
        (favoriteToggle)="onFavorite($event)"
        (cardClick)="onPropertyClick($event)"
        (mouseenter)="onHover(property.id)"
        (mouseleave)="onHover(null)">
      </app-property-card>
    </div>
  </div>

  <!-- Empty State (Only if not loading and empty) -->
  <div *ngIf="!isLoading && properties.length === 0" class="empty-state text-center py-5 text-muted">
    <i class="bi bi-house-x display-4 mb-3"></i>
    <h3 class="h5 fw-bold mb-2">No properties found</h3>
    <p class="small">Try adjusting your search or filters to find what you're looking for.</p>
  </div>

  <!-- Pagination -->
  <div *ngIf="properties.length > 0 && totalPages > 1" class="pagination-container mt-5 text-center">
    <nav aria-label="Property list pagination">
      <ul class="pagination justify-content-center flex-wrap mb-2">

        <!-- Previous -->
        <li class="page-item" [class.disabled]="currentPage === 1">
          <a class="page-link border-0 rounded-circle mx-1" href="javascript:void(0)"
             (click)="onPageChange(currentPage - 1)">
            <i class="bi bi-chevron-left"></i>
          </a>
        </li>

        <!-- Numbers -->
        <li *ngFor="let page of paginationRange" class="page-item" [class.active]="page === currentPage">
          <a class="page-link border-0 rounded-circle mx-1" href="javascript:void(0)"
             (click)="onPageChange(page)">{{ page }}</a>
        </li>

        <!-- Next -->
        <li class="page-item" [class.disabled]="currentPage === totalPages">
          <a class="page-link border-0 rounded-circle mx-1" href="javascript:void(0)"
             (click)="onPageChange(currentPage + 1)">
            <i class="bi bi-chevron-right"></i>
          </a>
        </li>

      </ul>
    </nav>

    <div class="pagination-info text-muted small">
      {{ (currentPage - 1) * pageSize + 1 }} – {{ Math.min(currentPage * pageSize, totalProperties) }} of {{ totalProperties }} places
    </div>
  </div>

</div>
