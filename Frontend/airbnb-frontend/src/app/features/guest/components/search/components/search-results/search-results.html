<div class="search-results-container" style="padding-top: 120px;">

  <app-filters
    [isOpen]="showFilters"
    (close)="onFiltersClose()"
    (applyFilters)="onFiltersApply($event)"
  ></app-filters>

  <!-- Loading Spinner -->
  <div *ngIf="isLoading" class="d-flex justify-content-center align-items-center w-100 py-5" style="min-height: 50vh;">
    <div class="spinner-border text-danger" role="status" style="width: 3rem; height: 3rem;">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>
  
  <!-- Content -->
  <div class="results-content" *ngIf="!isLoading">

    <!-- List Section -->
    <div class="results-list-section" [class.with-map]="showMap">
      <div class="container-fluid px-3"> 

       
        <div class="d-flex justify-content-between align-items-center mb-4 mt-2" *ngIf="properties.length > 0">
          <h1 class="h5 fw-bold text-dark mb-0">
            {{ totalResults }} homes found
          </h1>
        
        </div>

        <!-- Mobile Map Toggle -->
        <button class="map-toggle-btn d-lg-none" (click)="toggleMap()" type="button">
          <i class="bi" [ngClass]="showMap ? 'bi-list' : 'bi-map'"></i>
          <span>{{ showMap ? 'Show list' : 'Show map' }}</span>
        </button>

        <!-- 2. Grid (3 cards per row) -->
        <div *ngIf="properties.length > 0">
           <div class="row g-4">
            
             <div [class]="showMap ? 'col-12 col-sm-6 col-lg-4 col-xl-4' : 'col-12 col-sm-6 col-md-4 col-lg-3'"
                  *ngFor="let property of properties">

<app-property-card
  [property]="property"
  [isFavorite]="isPropertyInWishlist(property.id)"
  (favoriteToggle)="onToggleWishlist(property)"
  (cardClick)="onPropertySelect(property.id)"
  (mouseenter)="onPropertyHover(property.id)"
  (mouseleave)="onPropertyHover(null)">
</app-property-card>

             </div>
           </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="properties.length === 0" class="text-center py-5 mt-5">
          <h3 class="fw-bold text-dark">No properties found</h3>
          <p class="text-muted">Try adjusting your search or filters.</p>
        </div>

      </div>
    </div>

    <!-- Map Section -->
    <div class="results-map-section" *ngIf="showMap" [class.mobile-fullscreen]="!isDesktop">
      <app-search-map
        [properties]="properties"
        [selectedPropertyId]="selectedProperty?.id || null"
        (propertySelect)="onMapPropertySelect($event)"
        (mapBoundsChange)="onMapBoundsChange($event)"
        (mapBackgroundClick)="onMapBackgroundClick()"
      ></app-search-map>

      <button class="close-map-btn d-lg-none" (click)="toggleMap()" type="button">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>

  </div>
</div>
