<div class="search-results-container">

  <!--
    شريط الفلاتر والبحث
    يحتوي على السيرش بار الكبير + زر الفلتر
  -->
  <div class="filters-sticky-wrapper">
    <div class="container"> <!-- كونتينر عشان ييجي في النص -->
      <div class="row justify-content-center">
        <div class="col-12 col-xl-10">

          <!-- هنا بنستخدم السيرش بار الكبير ونفعل زرار الفلتر جنبه -->
          <app-search-bar
            [withFilterButton]="true"
            (search)="onSearchSubmit($event)"
            (filtersOpen)="onFiltersOpen()"
          ></app-search-bar>

        </div>
      </div>
    </div>
  </div>

  <!-- الفلاتر المنبثقة -->
  <app-filters
    [isOpen]="showFilters"
    (close)="onFiltersClose()"
    (applyFilters)="onFiltersApply($event)"
  ></app-filters>

  <div class="results-content">

    <!-- القائمة -->
    <div class="results-list-section" [class.with-map]="showMap">
      <div class="container-fluid">

        <button class="map-toggle-btn d-lg-none" (click)="toggleMap()" type="button">
          <i class="bi" [ngClass]="showMap ? 'bi-list' : 'bi-map'"></i>
          <span>{{ showMap ? 'Show list' : 'Show map' }}</span>
        </button>

        <app-property-list
          *ngIf="!showMap || isDesktop"
          (propertyHover)="onPropertyHover($event)"
          (propertySelect)="onPropertySelect($event)"
        ></app-property-list>
      </div>
    </div>

    <!-- الخريطة -->
    <div class="results-map-section" *ngIf="showMap" [class.mobile-fullscreen]="!isDesktop">
      <app-search-map
        [properties]="propertyList?.properties || []"
        [selectedPropertyId]="selectedProperty?.id || null"
        (propertySelect)="onMapPropertySelect($event)"
        (mapBoundsChange)="onMapBoundsChange($event)"
      ></app-search-map>

      <button class="close-map-btn d-lg-none" (click)="toggleMap()" type="button">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>
  </div>
</div>
