<div class="search-results-container">

  <!-- منطقة الفلاتر والسيرش بار الخاص بصفحة البحث -->
  <div class="filters-sticky-wrapper">
    <div class="container-fluid">
      <!-- رجعنا السيرش بار هنا عشان الفلاتر -->
      <!-- لاحظ: ممكن تستخدم [showFilters]="true" لو عدلنا الكومبوننت يقبلها، أو تسيبه زي ما هو -->
      <app-search-bar
        (search)="onSearchSubmit($event)"
        (filtersOpen)="onFiltersOpen()"
      ></app-search-bar>

      <!-- الفلاتر المنبثقة -->
      <app-filters
        [isOpen]="showFilters"
        (close)="onFiltersClose()"
        (applyFilters)="onFiltersApply($event)"
      ></app-filters>
    </div>
  </div>

  <div class="results-content">
    <!-- القائمة -->
    <div class="results-list-section" [class.with-map]="showMap">
      <div class="container-fluid">

        <button class="map-toggle-btn d-lg-none" (click)="toggleMap()" type="button">
          <i class="bi" [ngClass]="showMap ? 'bi-list' : 'bi-map'"></i>
          <span>{{ showMap ? 'Show list' : 'Show map' }}</span>
        </button>

        <app-property-list
          *ngIf="!showMap || isDesktop"
          (propertyHover)="onPropertyHover($event)"
          (propertySelect)="onPropertySelect($event)"
        ></app-property-list>
      </div>
    </div>

    <!-- الخريطة -->
    <div class="results-map-section" *ngIf="showMap" [class.mobile-fullscreen]="!isDesktop">
      <app-search-map
        [properties]="propertyList?.properties || []"
        [selectedPropertyId]="selectedProperty?.id || null"
        (propertySelect)="onMapPropertySelect($event)"
        (mapBoundsChange)="onMapBoundsChange($event)"
      ></app-search-map>

      <button class="close-map-btn d-lg-none" (click)="toggleMap()" type="button">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>
  </div>
</div>
