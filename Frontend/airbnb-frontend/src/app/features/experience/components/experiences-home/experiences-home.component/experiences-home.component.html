<div class="experiences-page">
  <app-header></app-header>
  
  <!-- Loading State -->
  <div *ngIf="isLoading()" class="loading-container">
    <div class="spinner"></div>
    <p>Loading experiences...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error()" class="error-container">
    <p>{{ error() }}</p>
    <button (click)="loadData()" class="retry-btn">Retry</button>
  </div>

  <!-- Main Content -->
  <div *ngIf="!isLoading() && !error()" class="main-container">
    
    <!-- 1. Airbnb Originals Section -->
    <section class="section" *ngIf="featuredExperiences().length > 0">
      <div class="section-header">
        <div>
          <h2 class="section-title">
            Airbnb Originals 
            <span class="arrow">›</span>
          </h2>
          <p class="section-subtitle">Hosted by the world's most interesting people</p>
        </div>
        <div class="nav-arrows">
          <button class="nav-arrow" (click)="scrollLeft('featured')" aria-label="Previous">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <path d="M8 2L4 6l4 4"/>
            </svg>
          </button>
          <button class="nav-arrow" (click)="scrollRight('featured')" aria-label="Next">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <path d="M4 2l4 4-4 4"/>
            </svg>
          </button>
        </div>
      </div>
      
      <div class="cards-scroll" id="featured">
        <app-experience-card 
          *ngFor="let exp of featuredExperiences()" 
          [experience]="exp"
          [isWishlisted]="!!exp.isFavorite" 
          [badgeText]="'Original'"
          [showBadge]="true">
        </app-experience-card>
      </div>
    </section>

    <!-- 2. Popular with travelers Section -->
    <section class="section" *ngIf="popularExperiences().length > 0">
      <div class="section-header">
        <div>
            <!-- نغير العنوان لو بنبحث -->
            <h2 class="section-title">{{ isSearching() ? 'Search Results' : 'Popular with travelers from your area' }}</h2>
        </div>

      <div class="nav-arrows">
          <button class="nav-arrow" (click)="scrollLeft('popular')" aria-label="Previous">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <path d="M8 2L4 6l4 4"/>
            </svg>
          </button>
          <button class="nav-arrow" (click)="scrollRight('popular')" aria-label="Next">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <path d="M4 2l4 4-4 4"/>
            </svg>
          </button>
        </div>
      </div>  
      
      <div class="cards-scroll" id="popular">
        <app-experience-card 
          *ngFor="let exp of popularExperiences()" 
          [experience]="exp"
          [isWishlisted]="!!exp.isFavorite"
          [badgeText]="'Popular'"
          [showBadge]="true">
        </app-experience-card>
      </div>
    </section>

    <!-- 3. Experiences in Paris Section -->
    <section class="section" *ngIf="parisExperiences().length > 0">
      <div class="section-header">
        <div>
          <h2 class="section-title">
            Experiences in Paris 
            <span class="arrow">›</span>
          </h2>
        </div>
        <div class="nav-arrows">
          <button class="nav-arrow" (click)="scrollLeft('paris')" aria-label="Previous">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <path d="M8 2L4 6l4 4"/>
            </svg>
          </button>
          <button class="nav-arrow" (click)="scrollRight('paris')" aria-label="Next">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <path d="M4 2l4 4-4 4"/>
            </svg>
          </button>
        </div>
      </div>
      
      <div class="cards-scroll" id="paris">
        <app-experience-card 
          *ngFor="let exp of parisExperiences()" 
          [experience]="exp"
          [isWishlisted]="!!exp.isFavorite"
          [badgeText]="'Popular'"
          [showBadge]="true">
        </app-experience-card>
      </div>
    </section>

    <!-- 4. Experiences in London Section -->
    <section class="section" *ngIf="londonExperiences().length > 0">
      <div class="section-header">
        <div>
          <h2 class="section-title">
            Experiences in London 
            <span class="arrow">›</span>
          </h2>
        </div>
        <div class="nav-arrows">
          <button class="nav-arrow" (click)="scrollLeft('london')" aria-label="Previous">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <path d="M8 2L4 6l4 4"/>
            </svg>
          </button>
          <button class="nav-arrow" (click)="scrollRight('london')" aria-label="Next">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <path d="M4 2l4 4-4 4"/>
            </svg>
          </button>
        </div>
      </div>
      
      <div class="cards-scroll" id="london">
        <app-experience-card 
          *ngFor="let exp of londonExperiences()" 
          [experience]="exp"
          [isWishlisted]="!!exp.isFavorite"
          [badgeText]="'Popular'"
          [showBadge]="true">
        </app-experience-card>
      </div>
    </section>

    <!-- ✅✅ No Results State ✅✅ -->
    <div *ngIf="featuredExperiences().length === 0 && 
                popularExperiences().length === 0 && 
                parisExperiences().length === 0 && 
                londonExperiences().length === 0" 
         class="empty-state">
      
      <div class="mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#dddddd" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"></circle>
          <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </div>
      
      <h3 class="fw-bold text-dark mb-2">No experiences found</h3>
      <p class="text-muted mb-4">Try adjusting your search or filters to find what you're looking for.</p>
      
      <button (click)="loadData()" class="btn btn-dark px-4 py-2 rounded-pill fw-semibold">
        Show all experiences
      </button>
    </div>

  </div>
</div>